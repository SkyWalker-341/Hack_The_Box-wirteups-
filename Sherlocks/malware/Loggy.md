# Sherlock Scenario

## Incident Summary
Janice from accounting was contacted by the SOC after her work credentials were discovered on the dark web by the threat intelligence team. Files recovered from her machine were sent to the REM analyst for further investigation.

---

### 1. What is the SHA-256 hash of this malware binary?
Using the `sha256sum` command on the file, we obtained the following hash:

**Answer:** `6acd8a362def62034cbd011e6632ba5120196e2011c83dc6045fcb28b590457c`

---

### 2. What programming language (and version) is this malware written in?
Using the `strings` command on the file, we identified "go" references. Extracting all related strings confirmed that the malware was written in Golang. The version found was `1.22.3`.

![Screenshot from 2025-02-25 19-29-03](https://github.com/user-attachments/assets/42b8c09d-33f9-448e-a652-8e86308e31be)

![Screenshot from 2025-02-25 19-29-23](https://github.com/user-attachments/assets/040a4d95-4326-4e0e-8eb1-0d0c4956065a)



**Answer:** `Golang 1.22.3`

---

### 3. Which GitHub repo suggests the malware's ability to exfiltrate data?
Using `grep`, we found multiple GitHub repositories. One repository, `github.com/jlaffaye/ftp`, was suspicious as it included FTP functionality for sending files.

`![Screenshot from 2025-02-25 19-38-37](https://github.com/user-attachments/assets/488a7d0e-41ba-43eb-89cb-6f844b76b1e2)



**Answer:** `github.com/jlaffaye/ftp`

---

### 4. What dependency, expressed as a GitHub repo, supports Janice’s assertion that she thought she downloaded something that could take screenshots?
Using `grep -i -E -o "github|screenshot"`, we filtered out the relevant repository.

![Screenshot from 2025-02-25 19-44-10](https://github.com/user-attachments/assets/e8b88180-9248-460d-b0b6-0f480d116bdd)


**Answer:** `github.com/kbinani/screenshot`

---

### 5. Which function call suggests that the malware produces a file after execution?
Using `grep -i -E -o "create|file"`, we identified the function call responsible for writing files.

![Screenshot from 2025-02-25 20-56-09](https://github.com/user-attachments/assets/449e8af3-0fc4-4830-85c2-7f084e6a81cc)


**Answer:** `WriteFile`

---

### 6. What domain is the malware exfiltrating data to?
Using `grep -iE "address"`, we extracted the domain the malware uses for FTP data exfiltration.

![Screenshot from 2025-02-25 20-01-10](https://github.com/user-attachments/assets/365e6f05-cd15-4894-b311-0b2e04e898b0)


**Answer:** `gotthem.htb`

---

### 7. What are the threat actor’s credentials?
Analyzing the malware in Ghidra, we identified the FTP function where the username and password were hardcoded.

![image](https://github.com/user-attachments/assets/f3c9a472-dd74-4595-8daa-08cba55bcf1c)


**Answer:** `NottaHacker:Cle@rtextP@ssword`

---

### 8. What file keeps getting written to disk?
The FTP function creates and writes to a file named `keylog.txt`.

![create](https://github.com/user-attachments/assets/1659bed1-126b-49a7-898e-cfbbf7d67b04)


**Answer:** `keylog.txt`

---

### 9. What is Janice's username and password after she changed it?
Examining the keylog file, we found the captured credentials.

![Screenshot from 2025-02-25 20-41-10](https://github.com/user-attachments/assets/62f59eed-e94c-4ca4-925f-5d1da52d50b4)

![Screenshot from 2025-02-25 20-41-38](https://github.com/user-attachments/assets/43b34463-84e9-4b15-9940-3d2fcae5191d)



**Answer:** `janice:Password123`

---

### 10. What app did Janice have open the last time she ran the "screenshot app"?
Examining the screenshot recovered from the malware's ZIP file, we identified the application.

![screenshot_1718068593](https://github.com/user-attachments/assets/a33b6d9e-1622-4ee6-90d2-90737441cc73)


**Answer:** `Solitaire`

